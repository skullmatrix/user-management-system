import{a as x}from"./chunk-FT7X5CIT.js";import{d as I,e as K,g as y}from"./chunk-I4CRZZPC.js";import{B as n,Ba as E,C as i,D as c,E as F,F as b,G as D,I as o,J as u,O as S,V as k,W as R,X as _,_ as j,fa as T,ga as w,ha as V,ia as G,ja as O,la as B,n as v,oa as q,p as M,q as L,s as m,sa as $,t as s,u as h,ua as z,v as g,w as l,wa as H,y as d,ya as J,za as C}from"./chunk-KIRRPNFL.js";var Z=e=>["/departments/edit",e];function ee(e,p){e&1&&c(0,"span",14)}function te(e,p){e&1&&(n(0,"span"),o(1,"Delete"),i())}function ie(e,p){if(e&1){let t=F();n(0,"tr")(1,"td"),o(2),i(),n(3,"td"),o(4),i(),n(5,"td"),o(6),i(),n(7,"td",9)(8,"a",11),o(9,"Edit"),i(),n(10,"button",12),b("click",function(){let r=M(t).$implicit,f=D();return L(f.deleteDepartment(r.id))}),l(11,ee,1,0,"span",13)(12,te,2,0,"span",8),i()()()}if(e&2){let t=p.$implicit;m(2),u(t.name),m(2),u(t.description),m(2),u(t.employeeCount||0),m(2),d("routerLink",S(7,Z,t.id)),m(2),d("disabled",t.isDeleting),m(),d("ngIf",t.isDeleting),m(),d("ngIf",!t.isDeleting)}}function ne(e,p){e&1&&(n(0,"tr")(1,"td",15),o(2,"No departments found"),i()())}var P=(()=>{class e{constructor(t){this.departmentService=t,this.departments=[]}ngOnInit(){this.departmentService.getAll().subscribe(t=>this.departments=t)}deleteDepartment(t){let a=this.departments.find(r=>r.id===t);a.isDeleting=!0,this.departmentService.delete(t).subscribe(()=>this.departments=this.departments.filter(r=>r.id!==t))}static{this.\u0275fac=function(a){return new(a||e)(s(y))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],standalone:!1,decls:23,vars:2,consts:[[1,"p-4"],[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[4,"ngIf"],[1,"text-right"],["routerLink","/departments/add",1,"btn","btn-primary"],[1,"btn","btn-sm","btn-primary","mr-1",3,"routerLink"],[1,"btn","btn-sm","btn-danger",3,"click","disabled"],["class","spinner-border spinner-border-sm",4,"ngIf"],[1,"spinner-border","spinner-border-sm"],["colspan","3",1,"text-center"]],template:function(a,r){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),o(4,"Departments"),i(),n(5,"div",4)(6,"div",5)(7,"table",6)(8,"thead")(9,"tr")(10,"th"),o(11,"Name"),i(),n(12,"th"),o(13,"Description"),i(),n(14,"th"),o(15,"Employee Count"),i(),c(16,"th"),i()(),n(17,"tbody"),l(18,ie,13,9,"tr",7)(19,ne,3,0,"tr",8),i()()(),n(20,"div",9)(21,"a",10),o(22,"Add Department"),i()()()()()()),a&2&&(m(18),d("ngForOf",r.departments),m(),d("ngIf",!(r.departments!=null&&r.departments.length)))},dependencies:[R,_,C],encapsulation:2})}}return e})();var re=e=>({"is-invalid":e});function oe(e,p){e&1&&(n(0,"div"),o(1,"Name is required"),i())}function ae(e,p){if(e&1&&(n(0,"div",13),l(1,oe,2,0,"div",14),i()),e&2){let t=D();m(),d("ngIf",t.f.name.errors.required)}}var N=(()=>{class e{constructor(t,a,r,f,U){this.formBuilder=t,this.route=a,this.router=r,this.departmentService=f,this.alertService=U}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({name:["",w.required],description:[""]}),this.isAddMode||this.departmentService.getById(this.id).subscribe(t=>this.form.patchValue(t))}get f(){return this.form.controls}onSubmit(){this.form.invalid||(this.isAddMode?this.createDepartment():this.updateDepartment())}createDepartment(){this.departmentService.create(this.form.value).subscribe({next:()=>{this.alertService.success("Department created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/departments"])},error:t=>this.alertService.error(t)})}updateDepartment(){this.departmentService.update(this.id,this.form.value).subscribe({next:()=>{this.alertService.success("Department updated successfully",{keepAfterRouteChange:!0}),this.router.navigate(["/departments"])},error:t=>this.alertService.error(t)})}static{this.\u0275fac=function(a){return new(a||e)(s($),s(H),s(J),s(y),s(K))}}static{this.\u0275cmp=h({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:7,consts:[[1,"p-4"],[1,"container"],[1,"card"],[1,"card-header"],[1,"card-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","description",1,"form-control"],[1,"text-center"],["type","submit",1,"btn","btn-primary","mr-1",3,"disabled"],["routerLink","/departments",1,"btn","btn-secondary"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(a,r){a&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"h3",3),o(4),i(),n(5,"div",4)(6,"form",5),b("ngSubmit",function(){return r.onSubmit()}),n(7,"div",6)(8,"label"),o(9,"Name"),i(),c(10,"input",7),l(11,ae,2,1,"div",8),i(),n(12,"div",6)(13,"label"),o(14,"Description"),i(),c(15,"textarea",9),i(),n(16,"div",10)(17,"button",11),o(18,"Save"),i(),n(19,"a",12),o(20,"Cancel"),i()()()()()()()),a&2&&(m(4),u(r.isAddMode?"Add Department":"Edit Department"),m(2),d("formGroup",r.form),m(4),d("ngClass",S(5,re,r.f.name.touched&&r.f.name.errors)),m(),d("ngIf",r.f.name.touched&&r.f.name.errors),m(6),d("disabled",r.form.invalid))},dependencies:[k,_,O,T,V,G,B,q,C],encapsulation:2})}}return e})();var me=[{path:"",component:P,canActivate:[x]},{path:"add",component:N,canActivate:[x],data:{roles:[I.Admin]}},{path:"edit/:id",component:N,canActivate:[x],data:{roles:[I.Admin]}}],Q=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=v({imports:[E.forChild(me),E]})}}return e})();var Ie=(()=>{class e{static{this.\u0275fac=function(a){return new(a||e)}}static{this.\u0275mod=g({type:e})}static{this.\u0275inj=v({imports:[j,z,Q]})}}return e})();export{Ie as DepartmentsModule};
