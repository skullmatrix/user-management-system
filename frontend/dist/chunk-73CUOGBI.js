import{d as Z}from"./chunk-FCZQ6OA4.js";import"./chunk-FT7X5CIT.js";import{b as A,e as Y}from"./chunk-I4CRZZPC.js";import{B as i,Ba as I,C as t,D as c,E as k,F as y,G as p,H as L,I as o,J as S,M as P,O as f,V as R,W as j,X as b,_ as D,fa as V,ga as u,ha as O,ia as B,ja as G,k as v,la as U,n as h,oa as $,p as M,pa as z,q,qa as H,ra as J,s as a,t as _,ta as K,u as E,ua as Q,v as C,w as l,wa as W,y as d,ya as X,z as F,za as x}from"./chunk-KIRRPNFL.js";function ae(e,s){if(e&1&&(i(0,"tr")(1,"td"),o(2),t(),i(3,"td"),o(4),t(),i(5,"td"),o(6),t(),i(7,"td"),o(8),t(),i(9,"td",7)(10,"a",8),o(11,"Edit"),t()()()),e&2){let n=s.$implicit;a(2),P("",n.title," ",n.firstName," ",n.lastName,""),a(2),S(n.email),a(),F("color",n.status==="InActive"?"red":"blue"),a(),S(n.status),a(2),S(n.role),a(2),L("routerLink","edit/",n.id,"")}}function de(e,s){e&1&&(i(0,"tr")(1,"td",9),c(2,"span",10),t()())}var ee=(()=>{class e{constructor(n){this.accountService=n}ngOnInit(){this.accountService.getAll().pipe(v()).subscribe(n=>this.accounts=n)}deleteAccount(n){let m=this.accounts.find(r=>r.id===n);m.isDeleting=!0,this.accountService.delete(n).pipe(v()).subscribe(()=>{this.accounts=this.accounts.filter(r=>r.id!==n)})}static{this.\u0275fac=function(m){return new(m||e)(_(A))}}static{this.\u0275cmp=E({type:e,selectors:[["ng-component"]],standalone:!1,decls:21,vars:2,consts:[["routerLink","add",1,"btn","btn-sm","btn-success","mb-2"],[1,"table","table-striped"],[2,"width","30%"],[2,"width","20%"],[2,"width","10%"],[4,"ngFor","ngForOf"],[4,"ngIf"],[2,"white-space","nowrap"],[1,"btn","btn-sm","btn-primary","mr-1",3,"routerLink"],["colspan","4",1,"text-center"],[1,"spinner-border","spinner-border-lg","align-center"]],template:function(m,r){m&1&&(i(0,"h1"),o(1,"Accounts"),t(),i(2,"p"),o(3,"All accounts from secure (admin only) api end point:"),t(),i(4,"a",0),o(5,"Create Account"),t(),i(6,"table",1)(7,"thead")(8,"tr")(9,"th",2),o(10,"Name"),t(),i(11,"th",2),o(12,"Email"),t(),i(13,"th",3),o(14,"Status"),t(),i(15,"th",3),o(16,"Role"),t(),c(17,"th",4),t()(),i(18,"tbody"),l(19,ae,12,10,"tr",5)(20,de,3,0,"tr",6),t()()),m&2&&(a(19),d("ngForOf",r.accounts),a(),d("ngIf",!r.accounts))},dependencies:[j,b,x],encapsulation:2})}}return e})();var g=e=>({"is-invalid":e});function se(e,s){e&1&&(i(0,"h1"),o(1,"Create Account"),t())}function le(e,s){e&1&&(i(0,"h1"),o(1,"Edit Account"),t())}function me(e,s){e&1&&(i(0,"div"),o(1,"Title is required"),t())}function ce(e,s){if(e&1&&(i(0,"div",29),l(1,me,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.title.errors.required)}}function pe(e,s){e&1&&(i(0,"div"),o(1,"First Name is required"),t())}function ue(e,s){if(e&1&&(i(0,"div",29),l(1,pe,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.firstName.errors.required)}}function fe(e,s){e&1&&(i(0,"div"),o(1,"Last Name is required"),t())}function ve(e,s){if(e&1&&(i(0,"div",29),l(1,fe,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.lastName.errors.required)}}function _e(e,s){e&1&&(i(0,"div"),o(1,"Email is required"),t())}function ge(e,s){e&1&&(i(0,"div"),o(1,"Email must be a valid email address"),t())}function he(e,s){if(e&1&&(i(0,"div",29),l(1,_e,2,0,"div",0)(2,ge,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.email.errors.required),a(),d("ngIf",n.f.email.errors.email)}}function Ee(e,s){e&1&&(i(0,"div"),o(1,"Role is required"),t())}function Ce(e,s){if(e&1&&(i(0,"div",29),l(1,Ee,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.role.errors.required)}}function Se(e,s){e&1&&(i(0,"div"),o(1,"Status is required"),t())}function be(e,s){if(e&1&&(i(0,"div",29),l(1,Se,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.status.errors.required)}}function xe(e,s){e&1&&(i(0,"div")(1,"h3",30),o(2,"Change Password"),t(),i(3,"p"),o(4,"Leave blank to keep the same password"),t()())}function Ae(e,s){e&1&&(i(0,"div"),o(1,"Password is required"),t())}function ye(e,s){e&1&&(i(0,"div"),o(1,"Password must be at least 6 characters"),t())}function Ie(e,s){if(e&1&&(i(0,"div",29),l(1,Ae,2,0,"div",0)(2,ye,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.password.errors.required),a(),d("ngIf",n.f.password.errors.minlength)}}function Ne(e,s){e&1&&(i(0,"div"),o(1,"Confirm Password is required"),t())}function we(e,s){e&1&&(i(0,"div"),o(1,"Passwords must match"),t())}function Te(e,s){if(e&1&&(i(0,"div",29),l(1,Ne,2,0,"div",0)(2,we,2,0,"div",0),t()),e&2){let n=p();a(),d("ngIf",n.f.confirmPassword.errors.required),a(),d("ngIf",n.f.confirmPassword.errors.mustMatch)}}function Me(e,s){e&1&&c(0,"span",31)}function qe(e,s){e&1&&c(0,"span",31)}function Fe(e,s){if(e&1){let n=k();i(0,"button",32),y("click",function(){M(n);let r=p();return q(r.onDelete())}),l(1,qe,1,0,"span",26),o(2," Delete "),t()}if(e&2){let n=p();d("disabled",n.deleting),a(),d("ngIf",n.deleting)}}var w=(()=>{class e{constructor(n,m,r,T,ie){this.formBuilder=n,this.route=m,this.router=r,this.accountService=T,this.alertService=ie,this.loading=!1,this.submitted=!1,this.deleting=!1}ngOnInit(){this.id=this.route.snapshot.params.id,this.isAddMode=!this.id,this.form=this.formBuilder.group({title:["",u.required],firstName:["",u.required],lastName:["",u.required],email:["",[u.required,u.email]],role:["",u.required],status:["Active"],password:["",[u.minLength(6),this.isAddMode?u.required:u.nullValidator]],confirmPassword:[""]},{validator:Z("password","confirmPassword")}),this.isAddMode||this.accountService.getById(this.id).pipe(v()).subscribe(n=>this.form.patchValue(n))}get f(){return this.form.controls}onSubmit(){this.submitted=!0,this.alertService.clear(),!this.form.invalid&&(this.loading=!0,this.isAddMode?this.createAccount():this.updateAccount())}createAccount(){this.accountService.create(this.form.value).pipe(v()).subscribe({next:()=>{this.alertService.success("Account created successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../"],{relativeTo:this.route})},error:n=>{this.alertService.error(n),this.loading=!1}})}updateAccount(){this.accountService.update(this.id,this.form.value).pipe(v()).subscribe({next:()=>{this.alertService.success("Update successful",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route})},error:n=>{this.alertService.error(n),this.loading=!1}})}onDelete(){confirm("Are you sure you want to delete this account?")&&(this.deleting=!0,this.accountService.delete(this.id).pipe(v()).subscribe({next:()=>{this.alertService.success("Account deleted successfully",{keepAfterRouteChange:!0}),this.router.navigate(["../../"],{relativeTo:this.route})},error:n=>{this.alertService.error(n),this.deleting=!1}}))}static{this.\u0275fac=function(m){return new(m||e)(_(K),_(W),_(X),_(A),_(Y))}}static{this.\u0275cmp=E({type:e,selectors:[["ng-component"]],standalone:!1,decls:72,vars:39,consts:[[4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-group","col"],["formControlName","title",1,"form-control",3,"ngClass"],["value",""],["value","Mr"],["value","Mrs"],["value","Miss"],["value","Ms"],["class","invalid-feedback",4,"ngIf"],[1,"form-group","col-5"],["type","text","formControlName","firstName",1,"form-control",3,"ngClass"],["type","text","formControlName","lastName",1,"form-control",3,"ngClass"],[1,"form-group","col-7"],["type","text","formControlName","email",1,"form-control",3,"ngClass"],["formControlName","role",1,"form-control",3,"ngClass"],["value","User"],["value","Admin"],["formControlName","status",1,"form-control",3,"ngClass"],["value","Active"],["value","InActive"],["type","password","formControlName","password",1,"form-control",3,"ngClass"],["type","password","formControlName","confirmPassword",1,"form-control",3,"ngClass"],[1,"form-group"],[1,"btn","btn-primary","mr-2",3,"disabled"],["class","spinner-border spinner-border-sm mr-1",4,"ngIf"],["type","button","class","btn btn-danger mr-2",3,"disabled","click",4,"ngIf"],["routerLink","/admin/accounts",1,"btn","btn-link"],[1,"invalid-feedback"],[1,"pt-3"],[1,"spinner-border","spinner-border-sm","mr-1"],["type","button",1,"btn","btn-danger","mr-2",3,"click","disabled"]],template:function(m,r){m&1&&(l(0,se,2,0,"h1",0)(1,le,2,0,"h1",0),i(2,"form",1),y("ngSubmit",function(){return r.onSubmit()}),i(3,"div",2)(4,"div",3)(5,"label"),o(6,"Title"),t(),i(7,"select",4),c(8,"option",5),i(9,"option",6),o(10,"Mr"),t(),i(11,"option",7),o(12,"Mrs"),t(),i(13,"option",8),o(14,"Miss"),t(),i(15,"option",9),o(16,"Ms"),t()(),l(17,ce,2,1,"div",10),t(),i(18,"div",11)(19,"label"),o(20,"First Name"),t(),c(21,"input",12),l(22,ue,2,1,"div",10),t(),i(23,"div",11)(24,"label"),o(25,"Last Name"),t(),c(26,"input",13),l(27,ve,2,1,"div",10),t()(),i(28,"div",2)(29,"div",14)(30,"label"),o(31,"Email"),t(),c(32,"input",15),l(33,he,3,2,"div",10),t(),i(34,"div",3)(35,"label"),o(36,"Role"),t(),i(37,"select",16),c(38,"option",5),i(39,"option",17),o(40,"User"),t(),i(41,"option",18),o(42,"Admin"),t()(),l(43,Ce,2,1,"div",10),t(),i(44,"div",3)(45,"label"),o(46,"Status"),t(),i(47,"select",19)(48,"option",20),o(49,"Active"),t(),i(50,"option",21),o(51,"InActive"),t()(),l(52,be,2,1,"div",10),t()(),l(53,xe,5,0,"div",0),i(54,"div",2)(55,"div",3)(56,"label"),o(57,"Password"),t(),c(58,"input",22),l(59,Ie,3,2,"div",10),t(),i(60,"div",3)(61,"label"),o(62,"Confirm Password"),t(),c(63,"input",23),l(64,Te,3,2,"div",10),t()(),i(65,"div",24)(66,"button",25),l(67,Me,1,0,"span",26),o(68," Save "),t(),l(69,Fe,3,2,"button",27),i(70,"a",28),o(71,"Cancel"),t()()()),m&2&&(d("ngIf",r.isAddMode),a(),d("ngIf",!r.isAddMode),a(),d("formGroup",r.form),a(5),d("ngClass",f(23,g,r.submitted&&r.f.title.errors)),a(10),d("ngIf",r.submitted&&r.f.title.errors),a(4),d("ngClass",f(25,g,r.submitted&&r.f.firstName.errors)),a(),d("ngIf",r.submitted&&r.f.firstName.errors),a(4),d("ngClass",f(27,g,r.submitted&&r.f.lastName.errors)),a(),d("ngIf",r.submitted&&r.f.lastName.errors),a(5),d("ngClass",f(29,g,r.submitted&&r.f.email.errors)),a(),d("ngIf",r.submitted&&r.f.email.errors),a(4),d("ngClass",f(31,g,r.submitted&&r.f.role.errors)),a(6),d("ngIf",r.submitted&&r.f.role.errors),a(4),d("ngClass",f(33,g,r.submitted&&r.f.status.errors)),a(5),d("ngIf",r.submitted&&r.f.status.errors),a(),d("ngIf",!r.isAddMode),a(5),d("ngClass",f(35,g,r.submitted&&r.f.password.errors)),a(),d("ngIf",r.submitted&&r.f.password.errors),a(4),d("ngClass",f(37,g,r.submitted&&r.f.confirmPassword.errors)),a(),d("ngIf",r.submitted&&r.f.confirmPassword.errors),a(2),d("disabled",r.loading),a(),d("ngIf",r.loading),a(2),d("ngIf",!r.isAddMode))},dependencies:[R,b,G,H,J,V,z,O,B,U,$,x],encapsulation:2})}}return e})();var ke=[{path:"",component:ee},{path:"add",component:w},{path:"edit/:id",component:w}],te=(()=>{class e{static{this.\u0275fac=function(m){return new(m||e)}}static{this.\u0275mod=C({type:e})}static{this.\u0275inj=h({imports:[I.forChild(ke),I]})}}return e})();var Ye=(()=>{class e{static{this.\u0275fac=function(m){return new(m||e)}}static{this.\u0275mod=C({type:e})}static{this.\u0275inj=h({imports:[D,Q,te]})}}return e})();export{Ye as AccountsModule};
